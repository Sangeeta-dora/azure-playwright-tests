# Test info

- Name: Create New Activity_With followup, email and attachament
- Location: /home/runner/work/azure-playwright-tests/azure-playwright-tests/azure-repo/tests/React_CreateNewActivity.spec.js:692:1

# Error details

```
Error: expect(received).toBe(expected) // Object.is equality

Expected: true
Received: false
    at /home/runner/work/azure-playwright-tests/azure-playwright-tests/azure-repo/tests/React_CreateNewActivity.spec.js:740:64
```

# Page snapshot

```yaml
- complementary:
  - navigation:
    - list:
      - listitem:
        - img "logo"
      - heading "Selenium_QA" [level=5]
      - listitem:
        - link "Home":
          - /url: /home
          - img
          - text: Home
      - listitem:
        - link "Dashboard":
          - /url: /dashboard
          - img
          - text: Dashboard
      - listitem:
        - img
        - text: Favorites
        - list:
          - listitem:
            - link "Communication ~ All 0":
              - /url: /allactivities
          - listitem:
            - link "Communication ~ All 0":
              - /url: /allactivities
          - listitem:
            - link "Communication ~ All 0":
              - /url: /allactivities
          - listitem:
            - link "Communication ~ All 0":
              - /url: /allactivities
          - listitem:
            - link "Communication ~ All 0":
              - /url: /allactivities
          - listitem:
            - link "Communication ~ All 0":
              - /url: /allactivities
          - listitem:
            - link "CompanyMaintenance ~ All 0":
              - /url: /admin/master-files/company
      - listitem:
        - img
        - text: Messages
        - list:
          - listitem:
            - link "Error Sending Email 38":
              - /url: /messages/mail-not-read?Mode=ErrorSendMailAlert&AssignedUserKey=230&AlertDesc=Error Sending Email&SettingID=~All&Tiles
          - listitem:
            - link "Internal Message 0":
              - /url: /messages/mail-not-read?Mode=InternalMessage&AssignedUserKey=230&AlertDesc=Internal Message&SettingID=~All&Tiles
          - listitem:
            - link "Draft Activities 5":
              - /url: /messages/draft-activity
          - listitem:
            - link "Expected Payment Promise Broken 184":
              - /url: /messages/expected-payments?Mode=BrokenPromise&AssignedUserKey=230&AlertDesc=Expected Payment Promise Broken&Tiles
          - listitem:
            - link "Mail Not Read 1":
              - /url: /messages/mail-not-read?Mode=UnreadMailAlert&AssignedUserKey=230&AlertDesc=Mail Not Read&SettingID=~All&Tiles
          - listitem:
            - link "Followup Past Due 2258":
              - /url: /messages/followup-past-due?ExcludeFromRule=False&SettingID=~PastDue&AssignedUserKey=230&MaxToDoDate=2025-08-25&Tiles
          - listitem:
            - link "Mail Not Filed 55":
              - /url: /messages/mail-not-filed
          - listitem:
            - link "Pending Pmt NOT Reconciled 2":
              - /url: /messages/pending-payment-not-reconciled?Mode=PendPmtNotReconciled&AssignedUserKey=230&AlertDesc=Pending Pmt NOT Reconciled&Tiles
          - listitem:
            - link "Followup Due Today 0":
              - /url: /messages/followup-past-due?ExcludeFromRule=False&SettingID=~DueToday&AssignedUserKey=230&MaxToDoDate=2025-08-26&MinToDoDate=2025-08-26&Tiles
          - listitem:
            - link "Open Issue without Open Activity 0":
              - /url: /messages/mail-not-read?Mode=OrphanIssue&AssignedUserKey=230&AlertDesc=Open Issue without Open Activity&SettingID=~All&Tiles
          - listitem:
            - link "Pending Payment Declined During Last 7 Days 0":
              - /url: /messages/pending-payment-not-reconciled?Mode=PendPmtDeclined&AssignedUserKey=230&AlertDesc=Pending Payment Declined During Last 7 Days&Tiles
      - listitem:
        - img
        - text: Activities
        - list:
          - listitem:
            - link "Email only 28":
              - /url: /activities/email-only?Mode=RuleAlert&RuleKey=4722&AlertDesc=Email only
          - listitem:
            - link "Report Only 2":
              - /url: /activities/report-only?Mode=RuleAlert&RuleKey=4669&AlertDesc=Report Only
          - listitem:
            - link "Email & Report 28":
              - /url: /activities/email-&-report?Mode=RuleAlert&RuleKey=4670&AlertDesc=Email & Report
          - listitem:
            - link "Invoice Rep Group 27":
              - /url: /activities/invoice-rep-group?Mode=RuleAlert&RuleKey=4723&AlertDesc=Invoice Rep Group
          - listitem:
            - link "Customer Report Group 28":
              - /url: /activities/customer-report-group?Mode=RuleAlert&RuleKey=4724&AlertDesc=Customer Report Group
          - listitem:
            - link "Embedded Report Test 28":
              - /url: /activities/embedded-report-test?Mode=RuleAlert&RuleKey=4725&AlertDesc=Embedded Report Test
          - listitem:
            - link "No Send 27":
              - /url: /activities/no-send?Mode=RuleAlert&RuleKey=4726&AlertDesc=No Send
          - listitem:
            - link "Invoice Contact & Primary 28":
              - /url: /activities/invoice-contact-&-primary?Mode=RuleAlert&RuleKey=4727&AlertDesc=Invoice Contact & Primary
          - listitem:
            - link "Invoice Contact Mix 82":
              - /url: /activities/invoice-contact-mix?Mode=RuleAlert&RuleKey=4728&AlertDesc=Invoice Contact Mix
          - listitem:
            - link "Invoice Contact 1 & 2 84":
              - /url: /activities/invoice-contact-1-&-2?Mode=RuleAlert&RuleKey=4729&AlertDesc=Invoice Contact 1 & 2
          - listitem:
            - link "Invoice Contact 2 83":
              - /url: /activities/invoice-contact-2?Mode=RuleAlert&RuleKey=4730&AlertDesc=Invoice Contact 2
          - listitem:
            - link "Invoice Contact 1 50":
              - /url: /activities/invoice-contact-1?Mode=RuleAlert&RuleKey=4731&AlertDesc=Invoice Contact 1
      - listitem:
        - img
        - text: Accounts
        - list:
          - listitem:
            - link "All accounts 0":
              - /url: /accounts/all-accounts
          - listitem:
            - link "Akshay_Test_Beaver 0":
              - /url: /account-overview?CustKey=259899&AssignedUserKey=230&SettingID=~All&OEM=LS
      - listitem:
        - img
        - text: Inquiries
        - list:
          - listitem:
            - text: By Account
            - list:
              - listitem:
                - link "Statement":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/Statements.aspx
              - listitem:
                - link "Contacts":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/Contacts.aspx
              - listitem:
                - link "Invoices":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/Invoices.aspx
              - listitem:
                - link "Payments":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/Payments.aspx
              - listitem:
                - link "Contact":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/AccountInfo.aspx
                  - text: Contact Info
              - listitem:
                - link "PortalMessages":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/PortalMessages.aspx
                  - text: Messages
              - listitem:
                - link "CreditInquiry":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/CreditInquiry.aspx
                  - text: Credit Inquiry
          - listitem:
            - text: By User
            - list:
              - listitem:
                - link "Contacts":
                  - /url: /inquiries/by-user/contacts
              - listitem:
                - link "Activity Summary":
                  - /url: /inquiries/by-user/activity-summary
              - listitem:
                - link "Activities":
                  - /url: /allactivities
              - listitem:
                - link "Expected Payments":
                  - /url: /inquiries/by-user/expected-payments
              - listitem:
                - link "Follow-Up":
                  - /url: /inquiries/by-user/follow-up
              - listitem:
                - link "Mail":
                  - /url: /inquiries/by-user/mail
              - listitem:
                - link "Invoices":
                  - /url: /inquiries/by-user/invoices
              - listitem:
                - link "Payments":
                  - /url: /inquiries/by-user/payments
              - listitem:
                - link "Pending Payment":
                  - /url: /inquiries/by-user/pending-payments
              - listitem:
                - link "Scheduled Payments":
                  - /url: /inquiries/by-user/scheduled-payments
              - listitem:
                - link "Projected Cash Receipts":
                  - /url: /inquiries/by-user/projected-cash-receipts
              - listitem:
                - link "Reporting Group Logs":
                  - /url: /inquiries/by-user/reporting-group-logs
      - listitem:
        - img
        - text: Admin
        - list:
          - listitem:
            - text: Master Files
            - list:
              - listitem:
                - link "Activity Templates":
                  - /url: /admin/master-files/activity-template
              - listitem:
                - link "Activity Types":
                  - /url: /admin/master-files/activity-types
              - listitem:
                - link "Company":
                  - /url: /admin/master-files/company
              - listitem:
                - link "Credit Class":
                  - /url: /admin/master-files/credit-class
              - listitem:
                - link "Customer":
                  - /url: /admin/master-files/customer
              - listitem:
                - link "Communication Template":
                  - /url: /admin/master-files/communication-template
              - listitem:
                - link "Reason Code":
                  - /url: /admin/master-files/reason-code
              - listitem:
                - link "Report":
                  - /url: /admin/master-files/report
              - listitem:
                - link "Reporting Groups":
                  - /url: /admin/master-files/reporting-groups
              - listitem:
                - link "Sales Rep":
                  - /url: /admin/master-files/sales-rep
              - listitem:
                - link "UserMaint":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/UserMaintenance.aspx
                  - text: Users
              - listitem:
                - link "Message Settings":
                  - /url: /admin/master-files/message-settings
          - listitem:
            - text: Settings & Utilities
            - list:
              - listitem:
                - link "CountryMaint":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/CountryMaintenance.aspx
                  - text: Country
              - listitem:
                - link "ImportCustNotes":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/ImportNotes.aspx
                  - text: Import
              - listitem:
                - link "Logs":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/Logs.aspx
              - listitem:
                - link "MailRetrieval":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/Mailretrieval.aspx
                  - text: Mail Retrieval
              - listitem:
                - link "EntityMassUpdate":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/EntityMassUpdate.aspx
                  - text: Mass Update
              - listitem:
                - link "SiteOptions":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/SiteOptions.aspx
                  - text: Site Options
              - listitem:
                - link "SyncSoftware":
                  - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/SyncSchedulesMaintenance.aspx
                  - text: Sync Setup
          - listitem:
            - link "AgeCustomers":
              - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/AgeCustomers.aspx
              - text: Age Accounts 0
          - listitem:
            - link "GenerateActions":
              - /url: https://web-qa.lockstep.network//(S(k5foi42ryhnkhfcfqaqgdpd3))/Pages/GenerateActions.aspx
              - text: Generate Actions 0
- img "Add to favorite"
- checkbox
- img
- text: Begin Typing Customer Name or ID ...
- combobox "Begin Typing Customer Name or ID ...": "8999: Akshay_Test_Beaver"
- button "Open"
- textbox
- img
- img "Upload"
- button "Support/FAQ": Help
- text: Select User to Assign
- button "Select User to Assign": Selenium QA
- img "Inbox"
- text: "24"
- textbox
- img
- button "OVERVIEW"
- button "DOCUMENTS"
- main:
  - 'heading "8999: Akshay_Test_Beaver" [level=6]'
  - heading "Company e2b Teknologies-DEV" [level=6]
  - heading "Statement of Accounts" [level=4]
  - button
  - text: View Settings
  - button "Select User to Assign": ~Statements
  - checkbox "Show Invoice Lines"
  - text: Show Invoice Lines
  - checkbox "Show All Accounts"
  - text: Show All Accounts
  - paragraph: Total Amount 1,055.00
  - paragraph: Total Balance 1,055.00
  - paragraph: Usually pays On time 
  - grid:
    - button "New Activity"
    - button "Payment"
    - button "FILTERS"
    - button "Select columns": Columns
    - button "Export To Excel"
    - button "Refresh"
    - button "BestFit":
      - img
      - text: BestFit
    - button "Density"
    - button "View Settings"
    - rowgroup:
      - row "Select all rows Invoice TranType Display Invoice Date Due Date PaySched Payment Amount Amount Balance CurrID Days Past Due View Activities View Applications Reason Code TotalPendPmt Consolidated Invc No":
        - columnheader "Select all rows":
          - checkbox "Select all rows"
        - columnheader "Invoice"
        - columnheader "TranType"
        - columnheader "Display"
        - columnheader "Invoice Date"
        - columnheader "Due Date"
        - columnheader "PaySched"
        - columnheader "Payment Amount"
        - columnheader "Amount"
        - columnheader "Balance"
        - columnheader "CurrID"
        - columnheader "Days Past Due"
        - columnheader "View Activities"
        - columnheader "View Applications"
        - columnheader "Reason Code"
        - columnheader "TotalPendPmt"
        - columnheader "Consolidated Invc No"
      - row "Checkbox selection Invoice TranType Display Invoice Date Due Date Select User to Assign Clear Payment Amount Amount Balance CurrID Days Past Due View Activities View Applications Reason Code TotalPendPmt Consolidated Invc No":
        - columnheader "Checkbox selection"
        - columnheader "Invoice":
          - text: Contains
          - textbox "Contains"
        - columnheader "TranType":
          - text: Contains
          - textbox "Contains"
        - columnheader "Display"
        - columnheader "Invoice Date":
          - text: Is
          - textbox "Is"
        - columnheader "Due Date":
          - text: Is
          - textbox "Is"
        - columnheader "Select User to Assign Clear":
          - button "Select User to Assign Clear": Clear
        - columnheader "Payment Amount"
        - columnheader "Amount":
          - text: Equals
          - spinbutton "Equals"
        - columnheader "Balance":
          - text: Equals
          - spinbutton "Equals"
        - columnheader "CurrID":
          - text: Contains
          - textbox "Contains"
        - columnheader "Days Past Due":
          - text: Equals
          - spinbutton "Equals"
        - columnheader "View Activities"
        - columnheader "View Applications"
        - columnheader "Reason Code":
          - text: Contains
          - textbox "Contains"
        - columnheader "TotalPendPmt":
          - text: Equals
          - spinbutton "Equals"
        - columnheader "Consolidated Invc No":
          - text: Contains
          - textbox "Contains"
    - row "Select row IN 06/04/2021 06/01/2021 80.00 80.00 USD 1,547 0.00":
      - cell "Select row":
        - checkbox "Select row"
      - cell
      - cell "IN"
      - cell
      - cell "06/04/2021"
      - cell "06/01/2021"
      - cell:
        - checkbox [disabled]
      - cell:
        - textbox [disabled]
      - cell "80.00"
      - cell "80.00"
      - cell "USD"
      - cell "1,547"
      - cell
      - cell
      - cell
      - cell "0.00"
      - cell
    - row "Select row IN 06/04/2021 06/04/2021 10.00 10.00 USD 1,544 0.00":
      - cell "Select row":
        - checkbox "Select row"
      - cell
      - cell "IN"
      - cell
      - cell "06/04/2021"
      - cell "06/04/2021"
      - cell:
        - checkbox [disabled]
      - cell:
        - textbox [disabled]
      - cell "10.00"
      - cell "10.00"
      - cell "USD"
      - cell "1,544"
      - cell
      - cell
      - cell
      - cell "0.00"
      - cell
    - row "Select row IN 06/04/2021 06/08/2021 120.00 120.00 USD 1,540 0.00":
      - cell "Select row":
        - checkbox "Select row"
      - cell
      - cell "IN"
      - cell
      - cell "06/04/2021"
      - cell "06/08/2021"
      - cell:
        - checkbox [disabled]
      - cell:
        - textbox [disabled]
      - cell "120.00"
      - cell "120.00"
      - cell "USD"
      - cell "1,540"
      - cell
      - cell
      - cell
      - cell "0.00"
      - cell
    - row "Select row IN 06/04/2021 06/27/2021 45.00 45.00 USD 1,521 0.00":
      - cell "Select row":
        - checkbox "Select row"
      - cell
      - cell "IN"
      - cell
      - cell "06/04/2021"
      - cell "06/27/2021"
      - cell:
        - checkbox [disabled]
      - cell:
        - textbox [disabled]
      - cell "45.00"
      - cell "45.00"
      - cell "USD"
      - cell "1,521"
      - cell
      - cell
      - cell
      - cell "0.00"
      - cell
    - row "Select row IN 06/06/2021 06/07/2021 800.00 800.00 USD 1,541 0.00":
      - cell "Select row":
        - checkbox "Select row"
      - cell
      - cell "IN"
      - cell
      - cell "06/06/2021"
      - cell "06/07/2021"
      - cell:
        - checkbox [disabled]
      - cell:
        - textbox [disabled]
      - cell "800.00"
      - cell "800.00"
      - cell "USD"
      - cell "1,541"
      - cell
      - cell
      - cell
      - cell "0.00"
      - cell
    - paragraph: "Rows per page:"
    - 'button "Rows per page: 20"': "20"
    - paragraph: 1–5 of 5
    - navigation "pagination navigation":
      - list:
        - listitem:
          - button "Go to previous page" [disabled]
        - listitem:
          - button "page 1": "1"
        - listitem:
          - button "Go to next page" [disabled]
  - heading "Activities" [level=4]
  - text: View Settings
  - button "Select User to Assign": ~All
  - checkbox "Show all activities for selected row"
  - text: Show all activities for selected row
  - checkbox "Show archived activities"
  - text: Show archived activities
  - grid:
    - button "FILTERS"
    - button "Select columns": Columns
    - button "Export To Excel"
    - button "Refresh"
    - button "Density"
    - button "View Settings"
    - rowgroup:
      - row "Select all rows Activity Date Activity Issue Notes  Received Mail Follow up Disputed Tagged Invoice  Sent Mail Attachments IssueComplete ActivityComplete ActivityAssignTo":
        - columnheader "Select all rows":
          - checkbox "Select all rows"
        - columnheader "Activity Date"
        - columnheader "Activity"
        - columnheader "Issue"
        - columnheader "Notes"
        - columnheader ""
        - columnheader "Received Mail"
        - columnheader "Follow up"
        - columnheader "Disputed"
        - columnheader "Tagged Invoice"
        - columnheader ""
        - columnheader "Sent Mail"
        - columnheader "Attachments":
          - img "Attachments"
        - columnheader "IssueComplete"
        - columnheader "ActivityComplete"
        - columnheader "ActivityAssignTo"
    - row "Select row 08/26/2025 New Activity - Multiple Tabs - Tue Aug 26 2025 12:32:05 GMT+0000 (Coordinated Universal Time) This is a test note for activity creation with notes functionality and today is Tue Aug 26 2025 12:32:05 GMT+0000 (Coordinated Universal Time)Phone call to:Akshay_Test_Beaver(C8999) Tagged Invoice Selenium_QA":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity - Multiple Tabs - Tue Aug 26 2025 12:32:05 GMT+0000 (Coordinated Universal Time)"
      - cell "This is a test note for activity creation with notes functionality and today is Tue Aug 26 2025 12:32:05 GMT+0000 (Coordinated Universal Time)Phone call to:Akshay_Test_Beaver(C8999)":
        - paragraph: This is a test note for activity creation with notes functionality and today is Tue Aug 26 2025 12:32:05 GMT+0000 (Coordinated Universal Time)Phone call to:Akshay_Test_Beaver(C8999)
      - cell
      - cell
      - cell
      - cell
      - cell "Tagged Invoice"
      - cell
      - cell
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "Selenium_QA"
    - row "Select row 08/26/2025 New Activity - Multiple Tabs - Tue Aug 26 2025 12:31:50 GMT+0000 (Coordinated Universal Time) Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User Open FollowUp Sent Email atest1":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity - Multiple Tabs - Tue Aug 26 2025 12:31:50 GMT+0000 (Coordinated Universal Time)"
      - cell "Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User":
        - paragraph: Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User
      - cell
      - cell
      - cell "Open FollowUp"
      - cell
      - cell
      - cell
      - cell "Sent Email"
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "atest1"
    - row "Select row 08/26/2025 New Activity- Notes - Tue Aug 26 2025 12:29:40 GMT+0000 (Coordinated Universal Time) This is a test note for activity creation with notes functionality and today is Tue Aug 26 2025 12:29:40 GMT+0000 (Coordinated Universal Time) Selenium_QA":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity- Notes - Tue Aug 26 2025 12:29:40 GMT+0000 (Coordinated Universal Time)"
      - cell "This is a test note for activity creation with notes functionality and today is Tue Aug 26 2025 12:29:40 GMT+0000 (Coordinated Universal Time)":
        - paragraph: This is a test note for activity creation with notes functionality and today is Tue Aug 26 2025 12:29:40 GMT+0000 (Coordinated Universal Time)
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "Selenium_QA"
    - row "Select row 08/26/2025 New Activity- Expected Payments - Tue Aug 26 2025 12:29:27 GMT+0000 (Coordinated Universal Time)  Selenium_QA":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity- Expected Payments - Tue Aug 26 2025 12:29:27 GMT+0000 (Coordinated Universal Time)"
      - cell:
        - paragraph
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell ""
      - cell
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "Selenium_QA"
    - row "Select row 08/26/2025 New Activity- Attachment - Tue Aug 26 2025 12:28:45 GMT+0000 (Coordinated Universal Time) Selenium_QA":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity- Attachment - Tue Aug 26 2025 12:28:45 GMT+0000 (Coordinated Universal Time)"
      - cell:
        - paragraph
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "Selenium_QA"
    - row "Select row 08/26/2025 New Activity- Email - Tue Aug 26 2025 12:27:52 GMT+0000 (Coordinated Universal Time) This is a test email body for activity creation with email functionality and today is Tue Aug 26 2025 12:27:52 GMT+0000 (Coordinated Universal Time) Sent Email Selenium_QA":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity- Email - Tue Aug 26 2025 12:27:52 GMT+0000 (Coordinated Universal Time)"
      - cell "This is a test email body for activity creation with email functionality and today is Tue Aug 26 2025 12:27:52 GMT+0000 (Coordinated Universal Time)":
        - paragraph: This is a test email body for activity creation with email functionality and today is Tue Aug 26 2025 12:27:52 GMT+0000 (Coordinated Universal Time)
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell "Sent Email"
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "Selenium_QA"
    - row "Select row 08/26/2025 New Activity- Email Template - Tue Aug 26 2025 12:27:49 GMT+0000 (Coordinated Universal Time) Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User Sent Email Selenium_QA":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity- Email Template - Tue Aug 26 2025 12:27:49 GMT+0000 (Coordinated Universal Time)"
      - cell "Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User":
        - paragraph: Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell "Sent Email"
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "Selenium_QA"
    - row "Select row 08/26/2025 New Activity- Followup - Tue Aug 26 2025 12:27:55 GMT+0000 (Coordinated Universal Time) Open FollowUp atest1":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity- Followup - Tue Aug 26 2025 12:27:55 GMT+0000 (Coordinated Universal Time)"
      - cell:
        - paragraph
      - cell
      - cell
      - cell "Open FollowUp"
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "atest1"
    - row "Select row 08/26/2025 New Activity- Email - Tue Aug 26 2025 15:22:59 GMT+0530 (India Standard Time) This is a test email body for activity creation with email functionality and today is Tue Aug 26 2025 15:22:59 GMT+0530 (India Standard Time) Sent Email Selenium_QA":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity- Email - Tue Aug 26 2025 15:22:59 GMT+0530 (India Standard Time)"
      - cell "This is a test email body for activity creation with email functionality and today is Tue Aug 26 2025 15:22:59 GMT+0530 (India Standard Time)":
        - paragraph: This is a test email body for activity creation with email functionality and today is Tue Aug 26 2025 15:22:59 GMT+0530 (India Standard Time)
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell "Sent Email"
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "Selenium_QA"
    - row "Select row 08/26/2025 New Activity- Followup - Tue Aug 26 2025 15:22:59 GMT+0530 (India Standard Time) Open FollowUp atest1":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity- Followup - Tue Aug 26 2025 15:22:59 GMT+0530 (India Standard Time)"
      - cell:
        - paragraph
      - cell
      - cell
      - cell "Open FollowUp"
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "atest1"
    - row "Select row 08/26/2025 New Activity- Email - Tue Aug 26 2025 14:59:46 GMT+0530 (India Standard Time) This is a test email body for activity creation with email functionality and today is Tue Aug 26 2025 14:59:46 GMT+0530 (India Standard Time) Sent Email Selenium_QA":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity- Email - Tue Aug 26 2025 14:59:46 GMT+0530 (India Standard Time)"
      - cell "This is a test email body for activity creation with email functionality and today is Tue Aug 26 2025 14:59:46 GMT+0530 (India Standard Time)":
        - paragraph: This is a test email body for activity creation with email functionality and today is Tue Aug 26 2025 14:59:46 GMT+0530 (India Standard Time)
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell "Sent Email"
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "Selenium_QA"
    - row "Select row 08/26/2025 New Activity- Followup - Tue Aug 26 2025 14:59:48 GMT+0530 (India Standard Time) Open FollowUp atest1":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/26/2025"
      - cell
      - cell "New Activity- Followup - Tue Aug 26 2025 14:59:48 GMT+0530 (India Standard Time)"
      - cell:
        - paragraph
      - cell
      - cell
      - cell "Open FollowUp"
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "atest1"
    - row "Select row 08/19/2025 New Activity - Multiple Tabs - Tue Aug 19 2025 17:54:32 GMT+0530 (India Standard Time) Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User  Sent Email Selenium_QA":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/19/2025"
      - cell
      - cell "New Activity - Multiple Tabs - Tue Aug 19 2025 17:54:32 GMT+0530 (India Standard Time)"
      - cell "Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User":
        - paragraph: Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User
      - cell
      - cell
      - cell
      - cell
      - cell
      - cell ""
      - cell "Sent Email"
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "Selenium_QA"
    - row "Select row 08/19/2025 New Activity - Multiple Tabs - Tue Aug 19 2025 17:53:12 GMT+0530 (India Standard Time) This is a test note for activity creation with notes functionality and today is Tue Aug 19 2025 17:53:12 GMT+0530 (India Standard Time)Phone call to:Akshay_Test_Beaver(C8999) Tagged Invoice Selenium_QA":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/19/2025"
      - cell
      - cell "New Activity - Multiple Tabs - Tue Aug 19 2025 17:53:12 GMT+0530 (India Standard Time)"
      - cell "This is a test note for activity creation with notes functionality and today is Tue Aug 19 2025 17:53:12 GMT+0530 (India Standard Time)Phone call to:Akshay_Test_Beaver(C8999)":
        - paragraph: This is a test note for activity creation with notes functionality and today is Tue Aug 19 2025 17:53:12 GMT+0530 (India Standard Time)Phone call to:Akshay_Test_Beaver(C8999)
      - cell
      - cell
      - cell
      - cell
      - cell "Tagged Invoice"
      - cell
      - cell
      - cell
      - cell:
        - checkbox [checked]
      - cell:
        - checkbox [checked]
      - cell "Selenium_QA"
    - row "Select row 08/19/2025 New Activity - Multiple Tabs - Tue Aug 19 2025 17:52:02 GMT+0530 (India Standard Time) Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User Open FollowUp Sent Email atest1":
      - cell "Select row":
        - checkbox "Select row"
      - cell "08/19/2025"
      - cell
      - cell "New Activity - Multiple Tabs - Tue Aug 19 2025 17:52:02 GMT+0530 (India Standard Time)"
      - cell "Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User":
        - paragraph: Dear Akshay_Test_Beaver, Your Account Statement is now available online. You can also review all Invoices and your Account anytime by clicking here for access to our secure web portal. The portal lets you view your statement, make a payment, download documents, or submit an inquiry. Questions, Please call . We are here to help. Thank you for your business! Sincerely, UnAssigned System User
      - cell
      - cell
      - cell "Open FollowUp"
      - cell
      - cell
      - cell
      - cell "Sent Email"
      - cell
      - cell:
        - checkbox
      - cell:
        - checkbox
      - cell "atest1"
    - paragraph: "Rows per page:"
    - 'button "Rows per page: 20"': "20"
    - paragraph: 1–20 of 128
    - navigation "pagination navigation":
      - list:
        - listitem:
          - button "Go to previous page" [disabled]
        - listitem:
          - button "page 1": "1"
        - listitem:
          - button "Go to page 2": "2"
        - listitem:
          - button "Go to page 3": "3"
        - listitem:
          - button "Go to page 4": "4"
        - listitem:
          - button "Go to page 5": "5"
        - listitem:
          - button "Go to page 6": "6"
        - listitem:
          - button "Go to page 7": "7"
        - listitem:
          - button "Go to next page"
  - heading "Account Notes" [level=4]
  - button "Add a Note"
  - grid:
    - rowgroup:
      - row "Entry Date Notes Actions":
        - columnheader "Entry Date"
        - columnheader "Notes"
        - columnheader "Actions"
    - text: No records found
    - paragraph: "Rows per page:"
    - 'button "Rows per page: 20"': "20"
    - paragraph: 0–0 of 0
    - navigation "pagination navigation":
      - list:
        - listitem:
          - button "Go to previous page" [disabled]
        - listitem:
          - button "Go to next page" [disabled]
- iframe
- iframe
- iframe
```

# Test source

```ts
  640 |     await expect(accountOverview.firstinvoice).toBeVisible()
  641 | })
  642 |
  643 | //TC_12: Create new activity with notes only and save it as draft
  644 | test('Create New Activity_With Notes and save it as Draft', async ({ page }, testInfo) => {
  645 |     const pageNav = new PageNavigation(page)
  646 |     const accountOverview = new AccountOverview(page)
  647 |     const allaccounts = new AllAccounts(page)
  648 |     const activityWindow = new ActivityCommunicateWindow(page)
  649 |     const draftActivities = new Messages_DraftActivities(page)
  650 |     const screenshotManager = new ScreenshotManager();
  651 |     
  652 |     var issueName = dataSet.Draft_IssueName + Date().toLocaleString()
  653 |     var notesText = dataSet.Test_Note + Date().toLocaleString()
  654 |
  655 |     //Click on New Activity
  656 |     await accountOverview.clickonNewActivity()
  657 |     await activityWindow.waitForActivtyToLoad()
  658 |
  659 |     //Enter Issue name
  660 |     await activityWindow.enterIssueName(issueName)
  661 |
  662 |     //Navigate to Notes tab and Add Notes
  663 |     await activityWindow.navigateToNotesTab()
  664 |     await activityWindow.addNotes(notesText)
  665 |     
  666 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Notes details before saving as draft")
  667 |
  668 |     //save as draft
  669 |     await activityWindow.clickonSaveAsDraft()
  670 |
  671 |     //Navigate to Messages > Draft Activities and validate Issue name
  672 |     await pageNav.navigateToMessagesUsinguniqueLocator()
  673 |     await pageNav.navigateToDraftActivities()
  674 |     await expect(draftActivities.firstrow).toBeVisible()
  675 |     expect(await draftActivities.validateDraftedIssueName(issueName)).toContain(issueName, "Draft Issue not created")
  676 |
  677 |     //Open Drafted issue and validate Notes details
  678 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Drafted Activity details after saving as draft")
  679 |     await draftActivities.OpenDraftedIssue(issueName)
  680 |     await activityWindow.waitForActivtyToLoad()
  681 |     await expect(await activityWindow.issuetxtarea).toHaveValue(/.+/)
  682 |
  683 |     //Navigate to Notes tab and validate Notes text
  684 |     await activityWindow.navigateToNotesTab()
  685 |     //validate Notes text
  686 |     expect(await draftActivities.returnDraftedNotesText()).toContain(notesText, "Note text is not matching")
  687 | })
  688 |
  689 | //-----------Create New activity by forming some combinations of above functionalities---------------//
  690 |
  691 | //TC_13: Create new activity with followup, email and attachment
  692 | test('Create New Activity_With followup, email and attachament', async ({ page }, testInfo) => {
  693 |     const accountOverview = new AccountOverview(page)
  694 |     const allaccounts = new AllAccounts(page)
  695 |     const activityWindow = new ActivityCommunicateWindow(page)
  696 |     const screenshotManager = new ScreenshotManager();
  697 |
  698 |     var issueName = dataSet.ActivityName_MultipleTabs + Date().toLocaleString()
  699 |
  700 |     await accountOverview.clickonNewActivity()
  701 |     await activityWindow.waitForActivtyToLoad()
  702 |
  703 |     //Enter Issue name
  704 |     await activityWindow.enterIssueName(issueName)
  705 |
  706 |     //set spoke with customer checkbox
  707 |     await activityWindow.clickonSpokewithCustomerCheckbox()
  708 |
  709 |     //Add Followup details
  710 |     await activityWindow.checkScheduleFollowupcheckbox()
  711 |     await activityWindow.selectFollowupAssignUser(dataSet, dataSet.Followup_AssignUser)
  712 |     await activityWindow.selectFollowupDate(dataSet)
  713 |     await activityWindow.fillvaluesinResponsedays(dataSet, dataSet.Followup_ResponseDays)
  714 |     await activityWindow.enterDescription(dataSet, dataSet.Followup_desc)
  715 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Followup details before save and send");
  716 |     
  717 |     //Navigate to Email tab and Add Email details
  718 |     await activityWindow.navigatetoemailTab()
  719 |     await activityWindow.enteraddressinTofield(dataSet, dataSet.To_Email_address)
  720 |     await activityWindow.clickonTemplate()
  721 |     await activityWindow.selectemailTemplate(dataSet, dataSet.Email_Template)
  722 |     await expect(activityWindow.subjectlineselector).toBeVisible()
  723 |     await expect(activityWindow.emailbodytextselector).toBeVisible()
  724 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Email details before save and send");
  725 |
  726 |     //Navigate to Attachments tab and Add Attachment (Report)
  727 |     await activityWindow.navigatetoAttachmentsTab()
  728 |     await activityWindow.clickonselectreportdrpdwn()
  729 |     await activityWindow.selectReport(dataSet, dataSet.Report_Name)
  730 |     await activityWindow.clickOnAttachReport()
  731 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Attachment details before save and send");
  732 |
  733 |     //save and send
  734 |     await activityWindow.clickSaveAndSend()
  735 |
  736 |     //validate Account Overview > Activity table with Issue name, Followup, Email sent and Attachment flags
  737 |     expect(await activityWindow.validateIssueName(issueName)).toContain(issueName, "Issue not created")
  738 |     expect(await activityWindow.validateFollowupflag(issueName)).toBe(true, "Followup is not set")
  739 |     expect(await activityWindow.validateEmailSent(issueName)).toBe(true, "Email is not sent")
> 740 |     expect(await activityWindow.validateAttachment(issueName)).toBe(true, "Attachment is not sent")
      |                                                                ^ Error: expect(received).toBe(expected) // Object.is equality
  741 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Activity listing in ACtivity table after creating activity with Followup, Email and Attachment");
  742 |
  743 |     //Refresh the page and Open Created Issue
  744 |     await activityWindow.clickOnRefreshbtn_statementtable()
  745 |     await activityWindow.OpenActivity(issueName)
  746 |     await activityWindow.waitForActivtyToLoad()
  747 |     await expect(await activityWindow.issuetxtarea).toHaveValue(/.+/)
  748 |     
  749 |     //-----------Validate Activity details---------------
  750 |
  751 |     //validate spoke with customer checkbox
  752 |     expect(await activityWindow.spokewithcustomerchkbx.isChecked()).toBe(true, "Spoke with customer checkbox is not checked")
  753 |
  754 |     //validate Followup details
  755 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Followup details after creating activity");
  756 |     expect(await activityWindow.returnAssignedUser()).toContain(dataSet.assignedUser, "Assigned user is not matching")
  757 |     expect(await activityWindow.schfollowupchkbox.isChecked()).toBe(true, "Followup checkbox is not checked")
  758 |     expect(await activityWindow.returnFollowupDate()).toContain(dataSet.followupDate, "Followup date is not matching")
  759 |     expect(await activityWindow.returnResponseDays()).toContain(dataSet.responseDays, "Response days is not matching")
  760 |     expect(await activityWindow.returnDescription()).toContain(dataSet.description, "Description is not matching")
  761 |
  762 |     //Navigate to Email tab and validate Email details
  763 |     await activityWindow.navigatetoemailTab()
  764 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Email details after creating activity");
  765 |     expect(await activityWindow.returnTocontactEmail()).toContain((dataSet.to_contact_id).trim(''), "To contact email is not matching")
  766 |     expect(await activityWindow.returnSubjectline()).toContain(dataSet.CustomerName, "Email subject line is not matching")
  767 |     expect(await activityWindow.returnEmailBodytext()).toContain(dataSet.CustomerName, "Email body text is not matching")
  768 |
  769 |     //Navigate to Attachments tab and validate Attachment
  770 |     await activityWindow.navigatetoAttachmentsTab()
  771 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Attachment details after creating activity");
  772 |     expect(await activityWindow.returnAttachedReportName()).toContain(dataSet.attachedReportName, "Report name is not matching")
  773 |
  774 | })
  775 |
  776 | //TC_14: Create new activity by adding notes, contacts and tagged invoices
  777 | test('Create New Activity_With Notes, Add contacts and Tagged Invoices', async ({ page }, testInfo) => {
  778 |     const accountOverview = new AccountOverview(page)
  779 |     const allaccounts = new AllAccounts(page)
  780 |     const activityWindow = new ActivityCommunicateWindow(page)
  781 |     const screenshotManager = new ScreenshotManager();
  782 |
  783 |     var issueName = dataSet.ActivityName_MultipleTabs + Date().toLocaleString()
  784 |     var notesText = dataSet.Test_Note + Date().toLocaleString()
  785 |
  786 |     //Click on New Activity
  787 |     await accountOverview.clickonNewActivity()
  788 |     await activityWindow.waitForActivtyToLoad()
  789 |
  790 |     //Enter Issue name
  791 |     await activityWindow.enterIssueName(issueName)
  792 |
  793 |     //Zoom out the page
  794 |     await page.evaluate(() => {
  795 |         document.body.style.zoom = '50%'; // Set the zoom level to 50%
  796 |     });
  797 |
  798 |     //Navigate to Notes tab and Add Notes
  799 |     await activityWindow.navigateToNotesTab()
  800 |     await activityWindow.addNotes(notesText) 
  801 |     //Add contacts to Notes
  802 |     await activityWindow.clickonViewContacts()
  803 |     await activityWindow.selectcontacttoAdd()
  804 |     let contactName1 = await activityWindow.returnContactName()
  805 |     console.log("Contact Name that should get displayed in Notes: ", contactName1)
  806 |     await activityWindow.clickonAddContactstoNotes()
  807 |     let contactName2 = await activityWindow.returnAddedContactNameinNotes()
  808 |     console.log("Contact Name that is displayed in Notes: ", contactName2)
  809 |     expect(contactName2).toContain(contactName1)
  810 |     let notesTabDetails = await activityWindow.returnnotestabdetails()
  811 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Notes details before saving activity with contacts"); 
  812 |
  813 |     //Navigate to Transactions tab and tag TranID
  814 |     await activityWindow.clickonTransactions()
  815 |     await activityWindow.clickonAll()
  816 |     await expect(activityWindow.transactiontblselector).toBeVisible()
  817 |     await activityWindow.clickonTagcheckbox()
  818 |     let docno1 = await activityWindow.returnTransactionID()
  819 |     console.log("Document Number before tagging: ", docno1)
  820 |     await activityWindow.clicktaggedtoissue()
  821 |     await expect(activityWindow.transactiontblselector).toBeVisible()
  822 |     let docno2 = await activityWindow.returnTransactionID()
  823 |     console.log("Document Number after tagging: ", docno2)
  824 |     expect(docno1).toEqual(docno2)
  825 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Transactions tab with Tagged TranID before saving activity");
  826 |
  827 |     //save
  828 |     await activityWindow.clikonSave()
  829 |
  830 |     //validate Account Overview > Activity table with Issue name and Notes
  831 |     expect(await activityWindow.validateIssueName(issueName)).toContain(issueName, "Issue not created")
  832 |     expect(await activityWindow.validateNotescell(issueName)).toContain(notesText, "Note not created")
  833 |     await screenshotManager.takeScreenshot(page, testInfo.title, "Activity listing in ACtivity table after creating activity with notes and Tagged TranID");
  834 |
  835 |     //Refresh the page and Open Created Issue
  836 |     await activityWindow.clickOnRefreshbtn_statementtable()
  837 |     await activityWindow.OpenActivity(issueName)
  838 |     await activityWindow.waitForActivtyToLoad()
  839 |     await expect(await activityWindow.issuetxtarea).toHaveValue(/.+/)
  840 |
```